<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <meta charset="UTF-8">
  <title>間食カロリーチェッカー - 食品情報登録</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="stylesheet" th:href="@{/css/base.css}">
</head>

<body>
  <div class="page">
    <div class="container">
      <div class="page-title">食品登録</div>
      <div class="page-sub">メーカーを選んで食品情報を登録します</div>
      <div th:if="${msg}" class="toast" th:text="${msg}">
      </div>
      <div th:if="${error}" class="error" th:text="${error}">
      </div>
      <div class="card" style="margin-top:10px;">
        <form th:action="@{/foods/create-and-next}" method="post" class="stack">
          <div class="stack">
            <label>メーカー</label>
            <select name="makerId" required>
              <option value="" disabled th:selected="${selectedMakerId == null}">選択してください</option>
              <option th:each="m : ${makers}" th:value="${m.food_maker_id}" th:text="${m.maker_name}" th:selected="${selectedMakerId != null and m.food_maker_id == selectedMakerId}">
              </option>
            </select>
          </div>
          <div class="stack">
            <label>食品名</label>
            <input class="input" type="text" name="foodName" required placeholder="例：じゃがりこ">
          </div>
          <br>
          <button class="btn btn-primary tap" type="submit">食品情報を登録して栄養情報登録へ進む</button>
        </form>
      </div>
      <hr class="hr">
      <div class="stack">
        <a class="btn btn-ghost tap" th:href="@{/}">TOPへ戻る</a>
      </div>
	  <!-- 下固定ナビ -->
	  <div style="height:72px;">
	  </div>
    </div>

  </div>
  <nav class="bottom-nav">
    <a class="nav-item" th:href="@{/eat}">
      <div class="nav-emoji">🍽</div>
      <div class="nav-label">食べた！</div>
    </a>
    <a class="nav-item" th:href="@{/makers/new}">
      <div class="nav-emoji">🏭</div>
      <div class="nav-label">メーカー登録</div>
    </a>
    <a class="nav-item is-active" th:href="@{/foods/new}">
      <div class="nav-emoji">🧃</div>
      <div class="nav-label">食品情報登録</div>
    </a>
    <a class="nav-item" th:href="@{/flavors/new}">
      <div class="nav-emoji">🧂</div>
      <div class="nav-label">栄養情報登録</div>
    </a>
  </nav>
  <script>
  // iOS Safariで :active を確実に効かせる
  document.addEventListener('touchstart', () => {}, {passive:true});
  //	遷移時アニメーション
  const kick = () => {
  const el = document.querySelector(".page");
  if(!el) return;
  el.classList.remove("is-ready"); // 再点火用
  requestAnimationFrame(() => el.classList.add("is-ready"));
  };
  document.addEventListener("DOMContentLoaded", kick);
  // iOS/Safari の戻る(キャッシュ復元)でも再点火
  window.addEventListener("pageshow", kick);
  </script>
</body>
</html>